1/10000
NO=2
t=15
N <- c(NO, numeric(t))
N
numeric(t)
dlog <- function(alpha = 0.01, rd=1, NO=2, t=15){#
	N <- c(NO, numeric(t))#
	for (i in 1:t) N[i + 1] <- {#
		N[i] + rd * N[i] * (1 - alpha * N[i])#
	}#
	return(N)#
}
dlog
dlog()
length(dlog())
dlog.res <- dlog()#
plot(0:15, dlog.res)
dlog.res <- dlog(a=0.1)#
plot(0:15, dlog.res)
dlog.res <- dlog(a=0.001)#
plot(0:15, dlog.res)
dlog.res <- dlog(a=1/10^9)#
plot(0:15, dlog.res)
dlog.res <- dlog(a=1/1000)#
plot(0:15, dlog.res)
dlog.res <- dlog(rd=0.1)#
plot(0:15, dlog.res)
dlog.res <- dlog(rd=3)#
plot(0:15, dlog.res)
dlog.res <- dlog(rd=1.5)#
plot(0:15, dlog.res)
dlog.res <- dlog(rd=2)#
plot(0:15, dlog.res)
dlog.res <- dlog(rd=2)#
plot(0:15, dlog.res, type="b")
dlog.res <- dlog(rd=2.5)#
plot(0:15, dlog.res, type="b")
dlog.res <- dlog(rd=3)#
plot(0:15, dlog.res, type="b")
dlog.res <- dlog(rd=3, t=100)#
plot(0:15, dlog.res, type="b")
dlog.res <- dlog(rd=3, t=100)#
plot(0:t, dlog.res, type="b")
tf <- 100#
dlog.res <- dlog(rd=3, t=tf)#
plot(0:tf, dlog.res, type="b")
tf <- 25#
dlog.res <- dlog(rd=3, t=tf)#
plot(0:tf, dlog.res, type="b")
tf <- 50#
dlog.res <- dlog(rd=3, t=tf)#
plot(0:tf, dlog.res, type="b")
tf <- 50#
dlog.res <- dlog(rd=2.5, t=tf)#
plot(0:tf, dlog.res, type="b")
total.incr <- Nts[1:t + 1] - Nts[1:t]
Nts <- dlog(rd=2.5, t=tf)#
plot(0:tf, Nts, type="b")#
#
# per capita population growth increments vs N ##
#
total.incr <- Nts[1:t + 1] - Nts[1:t]
tf <- 15#
Nts <- dlog(rd=2.5, t=tf)#
plot(0:tf, Nts, type="b")#
#
# per capita population growth increments vs N ##
#
total.incr <- Nts[1:t + 1] - Nts[1:t]
}#
tf <- 15#
Nts <- dlog()#
plot(0:tf, Nts, type="b")#
#
# per capita population growth increments vs N ##
#
total.incr <- Nts[1:t + 1] - Nts[1:t]
Nts
total.incr <- Nts[1:t + 1] - Nts[1:t]
total.incr
per.capita.incr <- total.incr/Nts[1:t]
per.capita.incr
plot(Nts[1:t], total.incr)
plot(Nts[1:t], per.capita.incr)
plot(Nts[1:t], total.incr)#
plot(Nts[1:t], per.capita.incr)
tf <- 15#
Nts <- dlog()#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=1)#
plot(0:tf, Nts, type="b"
)
tf <- 15#
Nts <- dlog(NO=10)#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=100)#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=50)#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=1)#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=0.1)#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=0.001)#
plot(0:tf, Nts, type="b")
tf <- 15#
Nts <- dlog(NO=1)#
plot(0:tf, Nts, type="b")
?runif
runif(30)
plot(1:10, runif(30))
plot(1:30, runif(30))
plot(1:30, dunif(30))
dunif(30)
dunif(100)
dunif(1:10)
qunif(30)
NOs <- c(0, runif(30) * 1.1 * 1/a)#
N <- sappy(NOs, function(n) dlog(NO=n))
NOs <- c(0, runif(30) * 1.1 * 1/a)#
N <- sapply(NOs, function(n) dlog(NO=n))
a <- 0.01#
t <- 15#
NOs <- c(0, runif(30) * 1.1 * 1/a)#
N <- sapply(NOs, function(n) dlog(NO=n))
N
x <- runif(10, 1,10)
x
test <- sapply(x, function(n) n*n)
test
plot(x, test)
test <- sapply(x, function(n) n*a)
test
NOs
test <- sapply(x, function(n) n:10)
test
test <- sapply(x, function(n) c(n,n,n))
test
test <- sapply(x, function(n) c(n,n,n,n))
test
matplot(0:t, N, type="l", lty = 1, lwd=0.75, col=1)
a <- 0.01#
t <- 15#
NOs <- c(0, runif(30) * 1.1 * 1/a)#
N <- sapply(NOs, function(n) dlog(NO=n))#
matplot(0:t, N, type="l", lty = 1, lwd=0.75, col=1)
a <- 0.01#
t <- 15#
NOs <- c(0, runif(30, 0, 5) * 1.1 * 1/a)#
N <- sapply(NOs, function(n) dlog(NO=n))#
matplot(0:t, N, type="l", lty = 1, lwd=0.75, col=1)
a <- 0.01#
t <- 15#
NOs <- c(0, runif(30, 0, 1.1) * 1.1 * 1/a)#
N <- sapply(NOs, function(n) dlog(NO=n))#
matplot(0:t, N, type="l", lty = 1, lwd=0.75, col=1)
NOs
matplot(0:t, N, type="l", lty = 1, lwd=0.75, col=1)#
text(t, 1/a, expression(italic("K")==1/a), adj=c(1,0))
matplot(0:t, N, type="l", lty = 1, lwd=0.75, col=1)#
text(t, 1/a, expression(italic("K")==1/alpha), adj=c(1,0))
a.s <- 1/runif(30, min=50, max=1000)		# K from 50 to 1000#
N <- sapply(a.s, function(a) dlog(alpha=a, t=15))
N
matplot(0:t, N, type="l", ylim=c(0,1000), lty=1, lwd=0.75, col=1)
matplot(0:t, N, type="l", ylim=c(0,1000), lty=1, lwd=0.75, col=1)#
text(8, 1/min(a.s), bquote(italic(alpha) == .(round(min(a.s), 3))), adj = c(1, 0.5))#
text(10, 1/max(a.s), bquote(italic(alpha) == .(round(max(a.s), 3))), adj = c(0, 1.2))
a.s <- 1/runif(30, min=50, max=1000)		# K from 50 to 1000#
N <- sapply(a.s, function(a) dlog(alpha=a, t=t))#
matplot(0:t, N, type="l", ylim=c(0,1000), lty=1, lwd=0.75, col=1)#
text(8, 1/min(a.s), bquote(italic(alpha) == .(round(min(a.s), 3))), adj = c(1, 0.5))#
text(10, 1/max(a.s), bquote(italic(alpha) == .(round(max(a.s), 3))), adj = c(0, 1.2))
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))
rd.v <- seq(1.3, 2.8, by=0.3)#
t <- 15#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))
rd.v <- seq(1.3, 2.8, by=0.3)#
t <- 15#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
matplot(0:t, Ns, type="l", col=1)
Ns
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))
tmp
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")
Ns2
str(Ns2)
?str
library(lattice)
library(ggplot2)
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(rd)
p
names(Ns2)
?facet_wrap
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd)
p
t <- 30#
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))#
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")#
	#str(Ns2)#
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd)
p
t <- 30#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))#
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")#
	#str(Ns2)#
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd)#
p
rd.v <- seq(1.3, 5, by=0.3)#
t <- 15#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
matplot(0:t, Ns, type="l", col=1)#
#
# presentation o limit cycles#
t <- 30#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))#
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")#
	#str(Ns2)#
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd)#
p
?facet_wrap
t <- 30#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))#
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")#
	#str(Ns2)#
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd, scales="free") #
p
rd.v <- seq(2, 3, by=0.1)#
t <- 15#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
matplot(0:t, Ns, type="l", col=1)#
#
# presentation o limit cycles#
t <- 30#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))#
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")#
	#str(Ns2)#
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd, scales="free") #
p
rd.v <- seq(2, 3.5, by=0.1)#
t <- 15#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
matplot(0:t, Ns, type="l", col=1)#
#
# presentation o limit cycles#
t <- 50#
Ns <- data.frame(sapply(rd.v, function(r) dlog(rd=r, t=t)))#
tmp <- data.frame(rd = as.factor(rd.v), t(Ns))#
Ns2 <- reshape(tmp, varying = list(2:ncol(tmp)), idvar="rd", v.names="N", direction="long")#
	#str(Ns2)#
library(ggplot2)#
p <- ggplot(Ns2, aes(time, N)) + #
	geom_line() +#
	facet_wrap(~ rd, scales="free") #
p
r
num.rd <- 201#
t <- 400#
rd.s <- seq(1,3,length=num.rd)
r
tmp <- sapply(rd.s, function(r) dlog(rd=r, t=t, NO=99))
tmp
?stack
require(stats)#
formula(PlantGrowth)         # check the default formula#
pg <- unstack(PlantGrowth)   # unstack according to this formula#
pg
stack(pg)
as.data.frame(tmp)
tmp.s <- stack(as.data.frame(tmp))
head(tmp.s)
?rep
c(1,2,3)
tmp <- c(1,2,3)
rep(tmp, each(2))
rep(tmp, each=2)
num.rd <- 201#
t <- 400#
rd.s <- seq(1,3,length=num.rd)#
tmp <- sapply(rd.s, function(r) dlog(rd=r, t=t, NO=99))#
tmp.s <- stack(as.data.frame(tmp))#
names(tmp.s) <- c("N", "OLD.column")#
tmp.s$rd <- rep(rd.s, each = t+1)#
tmp.s$time <- rep(0:t, num.rd)
head(tmp.s)
head(rd.s)
rd.s
num.rd <- 201#
t <- 400#
rd.s <- seq(1,3,length=num.rd)#
tmp <- sapply(rd.s, function(r) dlog(rd=r, t=t, NO=99))#
tmp.s <- stack(as.data.frame(tmp))#
names(tmp.s) <- c("N", "OLD.column")#
tmp.s$rd <- rep(rd.s, each = t+1)#
tmp.s$time <- rep(0:t, num.rd)#
N.bif <- subset(tmp.s, time > 0.5*t)#
plot(N ~ rd, data = N, pch=".", xlab=quote("r"["d"]))
plot(N ~ rd, data = N.bif, pch=".", xlab=quote("r"["d"]))
N.bif
num.rd <- 201#
t <- 400#
rd.s <- seq(1,3,length=num.rd)#
tmp <- sapply(rd.s, function(r) dlog(rd=r, t=t, NO=99))#
tmp.s <- stack(as.data.frame(tmp))#
names(tmp.s) <- c("N", "OLD.column")#
tmp.s$rd <- rep(rd.s, each = t+1)#
tmp.s$time <- rep(0:t, num.rd)#
N.bif <- subset(tmp.s, time > 0.5*t)#
plot(N ~ rd, data = N.bif, pch=".", xlab=quote("r"["d"]))
citation(fdrtool)
citation("fdrtool")
citation("ggplot2")
citation("fdrtool")
citation("Heatplus")
library(Heatplus)
citation("Heatplus")
library(vegan)
mantel
?mantel
library(ecodist)
library(help=ecodist)
?mantel
read.table("~/Desktop/1.F.A.1A.3vWWM610_RAST.tsv")
tbl <- read.table("~/Desktop/1.F.A.1A.3vWWM610_RAST.tsv", sep="\t", header=TRUE)
tbl <- read.table("~/Desktop/1.F.A.1A.3vWWM610_RAST.txt", sep="\t", header=TRUE)
unique(tbl[,2])
table(tbl[,2])
library(picante)
?mpd
library(PopGenome)
rm(list=ls())#
#
library(popgenome)
test <- 1:100
test = integer(test)
test = as.integer(test)
as.integer(test)
as.integer(test/18)
as.integer(test % 18)
as.integer(test %% 18)
test <- 0:99
as.integer(test %% 18)
?scale_colour_manual
library(ggplot2)
?scale_colour_manual
?sd
summary(1:10)
summary(0.1:1)
summary(00000.1:0.0001)
?summary
summary(00000.1:0.0001, digits=3)
summary(00000.1:0.0001, digits=5)
summary(attenu, digits = 4
)
summary(attenu, digits = 6
)
rm(list=ls())#
#
setwd("~/volumes/nyoungb2/perl/projects/ITEP_PopGen/dev/SNAP_batch/")#
tbl <- read.table("gtlenv-OTU2_dnds_sum.txt")
head(tbl)
colnames(tbl) <- c("cluster", "ds", "dn", "ds/dn")
tbl$cluster <- gsub(".+_([0-9]+).fasta", "\\1", tbl$cluster, perl=TRUE)
head(tbl)
colnames(tbl) <- c("cluster", "ds", "dn", "ds_dn")
tbl$dn_ds <- 1 / tbl$ds_dn
library(ggplot2)
ggplot(tbl, aes(cluster, dn_ds)) +#
	geom_point()
ggplot(tbl, aes(cluster, dn_ds, alpha=0.5)) +#
	geom_point(size=0.5)
ggplot(tbl, aes(cluster, dn_ds, alpha=0.5)) +#
	geom_point(size=0.75)
median.dnds <- median(tbl$dn_ds, na.rm=TRUE)
median.dnds
ggplot(tbl, aes(cluster, dn_ds, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	theme(#
		axis.text.x = element_blank(),#
		axis.ticks.x = element_blank()#
		)
ggplot(tbl, aes(cluster, dn_ds, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
ls
head(tbl)
?melt
library(reshape)
?melt
tbl.m <- melt(tbl, id.vars=c("cluster"))
head(tbl.m)
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ .) +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
rm(list=ls())#
library(ggplot2)#
library(reshape)#
#
setwd("~/volumes/nyoungb2/perl/projects/ITEP_PopGen/dev/SNAP_batch/")#
tbl <- read.table("gtlenv-OTU2_dnds_sum.txt")#
colnames(tbl) <- c("cluster", "ds", "dn", "ds_dn")#
tbl$cluster <- gsub(".+_([0-9]+).fasta", "\\1", tbl$cluster, perl=TRUE)#
#
tbl$dn_ds <- 1 / tbl$ds_dn#
# median of all dn_ds ##
median.dnds <- median(tbl$dn_ds, na.rm=TRUE)#
#
# melting ##
tbl$ds_dn <- NULL#
tbl.m <- melt(tbl, id.vars=c("cluster"))
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
head(tbl.m)
nrow(tbl.m)
max.dn_ds <- aggregate(tbl.m$dn_ds, list(tbl.m$cluster), max)
max.dn_ds <- aggregate(tbl.m$value, list(tbl.m$cluster), max)
head(max.dn.ds)
head(max.dn_ds)
tbl.m$cluster <- factor(tbl.m$cluster, levels=tbl$cluster[order(tbl$dn_ds)])
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
rm(list=ls())#
library(ggplot2)#
library(reshape)#
#
setwd("~/volumes/nyoungb2/perl/projects/ITEP_PopGen/dev/SNAP_batch/")#
tbl <- read.table("gtlenv-OTU2_dnds_sum.txt")#
colnames(tbl) <- c("cluster", "ds", "dn", "ds_dn")#
tbl$cluster <- gsub(".+_([0-9]+).fasta", "\\1", tbl$cluster, perl=TRUE)#
#
tbl$dn_ds <- 1 / tbl$ds_dn#
#
# removing NA rows ##
tbl <- tbl[, !which(is.na(tbl$dn_ds))]
median of all dn_ds ##
median.dnds <- median(tbl$dn_ds, na.rm=TRUE)#
#
# melting ##
tbl$ds_dn <- NULL#
tbl.m <- melt(tbl, id.vars=c("cluster"))#
#
# sorting by dn_ds ##
tbl.m$cluster <- factor(tbl.m$cluster, levels=tbl$cluster[order(tbl$dn_ds)])#
#
# plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
head(tbl)
rm(list=ls())#
library(ggplot2)#
library(reshape)#
#
setwd("~/volumes/nyoungb2/perl/projects/ITEP_PopGen/dev/SNAP_batch/")#
tbl <- read.table("gtlenv-OTU2_dnds_sum.txt")#
colnames(tbl) <- c("cluster", "ds", "dn", "ds_dn")#
tbl$cluster <- gsub(".+_([0-9]+).fasta", "\\1", tbl$cluster, perl=TRUE)#
#
tbl$dn_ds <- 1 / tbl$ds_dn
is.na(tbl$dn_ds)
tbl <- tbl[! which(is.na(tbl$dn_ds)), ]#
#
# median of all dn_ds ##
median.dnds <- median(tbl$dn_ds, na.rm=TRUE)#
#
# melting ##
tbl$ds_dn <- NULL#
tbl.m <- melt(tbl, id.vars=c("cluster"))#
#
# sorting by dn_ds ##
tbl.m$cluster <- factor(tbl.m$cluster, levels=tbl$cluster[order(tbl$dn_ds)])#
#
# plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
rm(list=ls())#
library(ggplot2)#
library(reshape)#
#
setwd("~/volumes/nyoungb2/perl/projects/ITEP_PopGen/dev/SNAP_batch/")#
tbl <- read.table("gtlenv-OTU2_dnds_sum.txt")#
colnames(tbl) <- c("cluster", "ds", "dn", "ds_dn")#
tbl$cluster <- gsub(".+_([0-9]+).fasta", "\\1", tbl$cluster, perl=TRUE)#
#
tbl$dn_ds <- 1 / tbl$ds_dn#
#
# removing NA rows ##
tbl <- tbl[! which(is.na(tbl$dn_ds)), ]
head(tbl)
rm(list=ls())#
library(ggplot2)#
library(reshape)#
#
setwd("~/volumes/nyoungb2/perl/projects/ITEP_PopGen/dev/SNAP_batch/")#
tbl <- read.table("gtlenv-OTU2_dnds_sum.txt")#
colnames(tbl) <- c("cluster", "ds", "dn", "ds_dn")#
tbl$cluster <- gsub(".+_([0-9]+).fasta", "\\1", tbl$cluster, perl=TRUE)#
#
tbl$dn_ds <- 1 / tbl$ds_dn
! which(is.na(tbl$dn_ds))
which(is.na(tbl$dn_ds))
! is.na(tbl$dn_ds)
tbl <- tbl[! is.na(tbl$dn_ds), ]#
#
# median of all dn_ds ##
median.dnds <- median(tbl$dn_ds, na.rm=TRUE)#
#
# melting ##
tbl$ds_dn <- NULL#
tbl.m <- melt(tbl, id.vars=c("cluster"))#
#
# sorting by dn_ds ##
tbl.m$cluster <- factor(tbl.m$cluster, levels=tbl$cluster[order(tbl$dn_ds)])#
#
# plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
tbl.m$cluster <- factor(tbl.m$cluster, levels=tbl$cluster[order(tbl$dn_ds, decreasing=TRUE)])#
#
# plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(yintercept=median.dnds, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
head(tbl)
head(tbl.m)
medians <- aggregate(tbl$value, list(tbl$variable))
medians <- aggregate(tbl$value, list(tbl$variable), median)
medians <- aggregate(tbl.m$value, list(tbl.m$variable), median)
medians
colnames(medians) <- c("variable", "intercept")
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(data=medians, yintercept=intercept, linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(data=medians, aes(yintercept=intercept), linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
tbl[tbl$dn_ds > 3, ]
0.01/0.04
0.01/(0.04 * 2)
0.01 * 2/0.04
tbl.m$variable <- factor(tbl.m$variable, levels=c("dn", "ds", "dn_ds"))#
#
# medians ##
medians <- aggregate(tbl.m$value, list(tbl.m$variable), median)#
colnames(medians) <- c("variable", "intercept")#
#
# plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(data=medians, aes(yintercept=intercept), linetype="dashed", alpha=0.5, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(data=medians, aes(yintercept=intercept), linetype="dashed", alpha=0.75, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	theme(#
		axis.text.x = element_blank() #,#
		#axis.ticks.x = element_blank()#
		)
plotting ##
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(data=medians, aes(yintercept=intercept), linetype="dashed", alpha=0.75, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	labs(x="gene cluster (ranked by dn/ds)")#
	theme(#
		axis.text.x = element_blank(),#
		axis.title.y = element_blank(),#
		legend.position = "none"#
		#axis.ticks.x = element_blank()#
		)
ggplot(tbl.m, aes(cluster, value, alpha=0.5)) +#
	geom_point(size=0.75) +#
	geom_hline(data=medians, aes(yintercept=intercept), linetype="dashed", alpha=0.75, color="red") +#
	facet_grid(variable ~ ., scales="free_y") +#
	labs(x="gene cluster (ranked by dn/ds)") +#
	theme(#
		axis.text.x = element_blank(),#
		axis.title.y = element_blank(),#
		legend.position = "none"#
		#axis.ticks.x = element_blank()#
		)
ggsave("gtlenv-OTU2_dnds_sum.pdf")
ggsave("gtlenv-OTU2_dnds_sum.png")
